<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>My Account</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link href='https://fonts.googleapis.com/css?family=Koulen' rel='stylesheet'>

    <link rel="stylesheet" href="/stylesheet/style.css" />
    <link rel="stylesheet" href="/stylesheet/myaccount.css" />
    <script src="/javascript/editAccount.js"></script>
    <script src="/javascript/dropDown.js"></script>
</head>

<body class="main-body">
    <header class="homepage-header">
        <!--Header section of the homepage-->
        <!--Automatically redirects to login page, unless logged in-->
        <div class="homepage-header-left">
            <!--Logo button that redirects to the homepage, whenever clicked.-->
            <a href="/homepage" class="logo-button">PAGEPALS</a>
            <!--Button that goes to the book club section when clicked-->
            <a href="/bookclubs" class="nav-link">Bookclubs</a>
            <!--Button that goes to the "my records" section when clicked-->
            <a href="/myrecord" class="nav-link">My Record</a>
        </div>
        <div class="homepage-header-right">
            <!--Search bar paired with search button beside it, currently just a placeholder-->
            <div class="search-bar">
                <input type="text" placeholder="Search" class="search-field" />
                <button class="search-button">Search</button>
            </div>
            <!--Username display with icon next to it, when Icon is clicked, has a dropdown menu-->
            <div class="user-info">
                <span class="greeting-msg">HELLO, USERNAME</span>
                <!--used a default profile image for display purpose-->
                <img src="/images/defaultProfile.png" alt="User Icon" class="user-icon" id="user-icon" />
                <div class="dropdown-menu" id="dropdown-menu">
                    <!--link to the account setting page-->
                    <a href="/myaccount" class="dropdown-menu-list">My account</a>
                    <!--link to profile setting page-->
                    <a href="/profile" class="dropdown-menu-list">Profile</a>
                    <!--link to log out-->
                    <a href="/logout" class="dropdown-menu-list">Log out</a>
                </div>
            </div>
        </div>
    </header>
    <div class="content-container">
        <h1>My Account</h1>

        <div class="accountDetails" id="userDisplay">
            <h2>Account Details</h2>
            <a href="#" onclick="editField()">Edit</a>

            <p>Username: <span id="usernameDisplay" th:text="${user.username}">Username</span></p>
            <!-- Password display as part of test -->
            <p>Password: <span id="passwordDisplay" th:text="${user.password}">Password</span></p>
            <p>Bio: <span id="bioDisplay" th:text="${user.bio} ? ${user.bio} : ' '"></span></p>
        </div>


        <!-- form to change user info
        form doesn't appear until user clicks edit -->
        <div id="editForm" style="display: none;">
            <h2>Edit Account Details</h2>
            <!-- return false just disables default behaviour -->
            <form th:action="@{/user/{id}(id=${user.id})}" onsubmit="saveChanges(); return false;">
                <!-- Hidden input field for user ID for passing into backend -->
                <input type="hidden" id="userId" name="userId" th:value="${user.id}">

                <label for="editUsername">Username:</label><br>
                <input type="text" id="editUsername" name="editUsername" maxlength="255" required><br><br>

                <!-- remove later for security -->
                <label for="editPassword">Password:</label><br>
                <input type="password" id="editPassword" name="editPassword" maxlength="255" required><br><br>

                <label for="editBio">Bio:</label><br>
                <textarea id="editBio" name="editBio" placeholder="Enter your bio (500 chars max)" maxlength="500"></textarea><br><br>

                <button type="button" onclick="cancelEdit()">Cancel</button>
                <button type="submit">Save Changes</button>
            </form>
        </div>

        <div id="manageAccountDisplay">
            <h2>Manage Account</h2><br>
            <form id="deleteForm">
                <button type="button" class="delete-btn" onclick="deleteUser()">Delete Account</button><br><br>
            </form>
            <a href="/logout">Log Out</a>
        </div>

    </div>
</body>

</html>